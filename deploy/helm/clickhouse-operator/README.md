# altinity-clickhouse-operator

![Version: 0.24.0](https://img.shields.io/badge/Version-0.24.0-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 0.24.0](https://img.shields.io/badge/AppVersion-0.24.0-informational?style=flat-square)

Helm chart to deploy [altinity-clickhouse-operator](https://github.com/Altinity/clickhouse-operator).

The ClickHouse Operator creates, configures and manages ClickHouse clusters running on Kubernetes.

For upgrade please install CRDs separately:
```bash
  kubectl apply -f https://github.com/Altinity/clickhouse-operator/raw/master/deploy/helm/clickhouse-operator/crds/CustomResourceDefinition-clickhouseinstallations.clickhouse.altinity.com.yaml
  kubectl apply -f https://github.com/Altinity/clickhouse-operator/raw/master/deploy/helm/clickhouse-operator/crds/CustomResourceDefinition-clickhouseinstallationtemplates.clickhouse.altinity.com.yaml
  kubectl apply -f https://github.com/Altinity/clickhouse-operator/raw/master/deploy/helm/clickhouse-operator/crds/CustomResourceDefinition-clickhouseoperatorconfigurations.clickhouse.altinity.com.yaml
```

**Homepage:** <https://github.com/Altinity/clickhouse-operator>

## Maintainers

| Name | Email | Url |
| ---- | ------ | --- |
| altinity | <support@altinity.com> |  |

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| additionalResources | list | `[]` | list of additional resources to create (are processed via `tpl` function), useful for create ClickHouse clusters together with clickhouse-operator, look `kubectl explain chi` for details |
| affinity | object | `{}` | affinity for scheduler pod assignment, look `kubectl explain pod.spec.affinity` for details |
| configs | object | `{"confdFiles":null,"configdFiles":{"01-clickhouse-01-listen.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<yandex>\n    <!-- Listen wildcard address to allow accepting connections from other containers and host network. -->\n    <listen_host>::</listen_host>\n    <listen_host>0.0.0.0</listen_host>\n    <listen_try>1</listen_try>\n</yandex>\n","01-clickhouse-02-logger.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<yandex>\n    <logger>\n        <!-- Possible levels: https://github.com/pocoproject/poco/blob/devel/Foundation/include/Poco/Logger.h#L439 -->\n        <level>debug</level>\n        <log>/var/log/clickhouse-server/clickhouse-server.log</log>\n        <errorlog>/var/log/clickhouse-server/clickhouse-server.err.log</errorlog>\n        <size>1000M</size>\n        <count>10</count>\n        <!-- Default behavior is autodetection (log to console if not daemon mode and is tty) -->\n        <console>1</console>\n    </logger>\n</yandex>\n","01-clickhouse-03-query_log.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<yandex>\n    <query_log replace=\"1\">\n        <database>system</database>\n        <table>query_log</table>\n        <engine>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + interval 30 day</engine>\n        <flush_interval_milliseconds>7500</flush_interval_milliseconds>\n    </query_log>\n    <query_thread_log remove=\"1\"/>\n</yandex>\n","01-clickhouse-04-part_log.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<yandex>\n    <part_log replace=\"1\">\n        <database>system</database>\n        <table>part_log</table>\n        <engine>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + interval 30 day</engine>\n        <flush_interval_milliseconds>7500</flush_interval_milliseconds>\n    </part_log>\n</yandex>\n","01-clickhouse-05-trace_log.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<yandex>\n    <trace_log replace=\"1\">\n        <database>system</database>\n        <table>trace_log</table>\n        <engine>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + interval 30 day</engine>\n        <flush_interval_milliseconds>7500</flush_interval_milliseconds>\n    </trace_log>\n</yandex>"},"etcClickhouseOperatorConfdFiles":null,"etcClickhouseOperatorConfigdFiles":{"01-clickhouse-01-listen.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<yandex>\n    <!-- Listen wildcard address to allow accepting connections from other containers and host network. -->\n    <listen_host>::</listen_host>\n    <listen_host>0.0.0.0</listen_host>\n    <listen_try>1</listen_try>\n</yandex>\n","01-clickhouse-02-logger.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<yandex>\n    <logger>\n        <!-- Possible levels: https://github.com/pocoproject/poco/blob/devel/Foundation/include/Poco/Logger.h#L439 -->\n        <level>debug</level>\n        <log>/var/log/clickhouse-server/clickhouse-server.log</log>\n        <errorlog>/var/log/clickhouse-server/clickhouse-server.err.log</errorlog>\n        <size>1000M</size>\n        <count>10</count>\n        <!-- Default behavior is autodetection (log to console if not daemon mode and is tty) -->\n        <console>1</console>\n    </logger>\n</yandex>\n","01-clickhouse-03-query_log.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<yandex>\n    <query_log replace=\"1\">\n        <database>system</database>\n        <table>query_log</table>\n        <engine>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + interval 30 day</engine>\n        <flush_interval_milliseconds>7500</flush_interval_milliseconds>\n    </query_log>\n    <query_thread_log remove=\"1\"/>\n</yandex>\n","01-clickhouse-04-part_log.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<yandex>\n    <part_log replace=\"1\">\n        <database>system</database>\n        <table>part_log</table>\n        <engine>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + interval 30 day</engine>\n        <flush_interval_milliseconds>7500</flush_interval_milliseconds>\n    </part_log>\n</yandex>\n","01-clickhouse-05-trace_log.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<yandex>\n    <trace_log replace=\"1\">\n        <database>system</database>\n        <table>trace_log</table>\n        <engine>Engine = MergeTree PARTITION BY event_date ORDER BY event_time TTL event_date + interval 30 day</engine>\n        <flush_interval_milliseconds>7500</flush_interval_milliseconds>\n    </trace_log>\n</yandex>"},"etcClickhouseOperatorFiles":{"config.yaml":{"annotation":{"exclude":[],"include":[]},"clickhouse":{"access":{"password":"","port":8123,"rootCA":"","scheme":"auto","secret":{"name":"{{ include \"altinity-clickhouse-operator.fullname\" . }}","namespace":""},"timeouts":{"connect":1,"query":4},"username":""},"configuration":{"file":{"path":{"common":"chi/config.d","host":"chi/conf.d","user":"chi/users.d"}},"network":{"hostRegexpTemplate":"(chi-{chi}-[^.]+\\d+-\\d+|clickhouse\\-{chi})\\.{namespace}\\.svc\\.cluster\\.local$"},"user":{"default":{"networksIP":["::1","127.0.0.1"],"password":"default","profile":"default","quota":"default"}}},"configurationRestartPolicy":{"rules":[{"rules":[{"settings/*":"yes"},{"settings/access_control_path":"no"},{"settings/dictionaries_config":"no"},{"settings/max_server_memory_*":"no"},{"settings/max_*_to_drop":"no"},{"settings/max_concurrent_queries":"no"},{"settings/models_config":"no"},{"settings/user_defined_executable_functions_config":"no"},{"settings/logger/*":"no"},{"settings/macros/*":"no"},{"settings/remote_servers/*":"no"},{"settings/user_directories/*":"no"},{"zookeeper/*":"yes"},{"files/*.xml":"yes"},{"files/config.d/*.xml":"yes"},{"files/config.d/*dict*.xml":"no"},{"profiles/default/background_*_pool_size":"yes"},{"profiles/default/max_*_for_server":"yes"}],"version":"*"},{"rules":[{"settings/logger":"yes"}],"version":"21.*"}]},"metrics":{"timeouts":{"collect":9}}},"keeper":{"configuration":{"file":{"path":{"common":"chk/keeper_config.d","host":"chk/conf.d","user":"chk/users.d"}}}},"label":{"appendScope":"no","exclude":[],"include":[]},"logger":{"alsologtostderr":"false","log_backtrace_at":"","logtostderr":"true","stderrthreshold":"","v":"1","vmodule":""},"pod":{"terminationGracePeriod":30},"reconcile":{"host":{"wait":{"exclude":true,"include":false,"queries":true}},"runtime":{"reconcileCHIsThreadsNumber":10,"reconcileShardsMaxConcurrencyPercent":50,"reconcileShardsThreadsNumber":5},"statefulSet":{"create":{"onFailure":"ignore"},"update":{"onFailure":"abort","pollInterval":5,"timeout":300}}},"statefulSet":{"revisionHistoryLimit":0},"template":{"chi":{"path":"chi/templates.d","policy":"ApplyOnNextReconcile"},"chk":{"path":"chk/templates.d","policy":"ApplyOnNextReconcile"}},"watch":{"namespaces":[]}}},"etcClickhouseOperatorTemplatesdFiles":{"001-templates.json.example":"{\n  \"apiVersion\": \"clickhouse.altinity.com/v1\",\n  \"kind\": \"ClickHouseInstallationTemplate\",\n  \"metadata\": {\n    \"name\": \"01-default-volumeclaimtemplate\"\n  },\n  \"spec\": {\n    \"templates\": {\n      \"volumeClaimTemplates\": [\n        {\n          \"name\": \"chi-default-volume-claim-template\",\n          \"spec\": {\n            \"accessModes\": [\n              \"ReadWriteOnce\"\n            ],\n            \"resources\": {\n              \"requests\": {\n                \"storage\": \"2Gi\"\n              }\n            }\n          }\n        }\n      ],\n      \"podTemplates\": [\n        {\n          \"name\": \"chi-default-oneperhost-pod-template\",\n          \"distribution\": \"OnePerHost\",\n          \"spec\": {\n            \"containers\" : [\n              {\n                \"name\": \"clickhouse\",\n                \"image\": \"clickhouse/clickhouse-server:23.8\",\n                \"ports\": [\n                  {\n                    \"name\": \"http\",\n                    \"containerPort\": 8123\n                  },\n                  {\n                    \"name\": \"client\",\n                    \"containerPort\": 9000\n                  },\n                  {\n                    \"name\": \"interserver\",\n                    \"containerPort\": 9009\n                  }\n                ]\n              }\n            ]\n          }\n        }\n      ]\n    }\n  }\n}\n","default-pod-template.yaml.example":"apiVersion: \"clickhouse.altinity.com/v1\"\nkind: \"ClickHouseInstallationTemplate\"\nmetadata:\n  name: \"default-oneperhost-pod-template\"\nspec:\n  templates:\n    podTemplates:\n      - name: default-oneperhost-pod-template\n        distribution: \"OnePerHost\"\n","default-storage-template.yaml.example":"apiVersion: \"clickhouse.altinity.com/v1\"\nkind: \"ClickHouseInstallationTemplate\"\nmetadata:\n  name: \"default-storage-template-2Gi\"\nspec:\n  templates:\n    volumeClaimTemplates:\n      - name: default-storage-template-2Gi\n        spec:\n          accessModes:\n            - ReadWriteOnce\n          resources:\n            requests:\n              storage: 2Gi\n","readme":"Templates in this folder are packaged with an operator and available via 'useTemplate'"},"etcClickhouseOperatorUsersdFiles":{"01-clickhouse-operator-profile.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<!--\n#\n# Template parameters available:\n#\n-->\n<yandex>\n    <!-- clickhouse-operator user is generated by the operator based on config.yaml in runtime -->\n    <profiles>\n        <clickhouse_operator>\n            <log_queries>0</log_queries>\n            <skip_unavailable_shards>1</skip_unavailable_shards>\n            <http_connection_timeout>10</http_connection_timeout>\n            <max_concurrent_queries_for_all_users>0</max_concurrent_queries_for_all_users>\n            <os_thread_priority>0</os_thread_priority>\n        </clickhouse_operator>\n    </profiles>\n</yandex>\n","02-clickhouse-default-profile.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<yandex>\n  <profiles>\n    <default>\n      <os_thread_priority>2</os_thread_priority>\n      <log_queries>1</log_queries>\n      <connect_timeout_with_failover_ms>1000</connect_timeout_with_failover_ms>\n      <distributed_aggregation_memory_efficient>1</distributed_aggregation_memory_efficient>\n      <parallel_view_processing>1</parallel_view_processing>\n      <do_not_merge_across_partitions_select_final>1</do_not_merge_across_partitions_select_final>\n      <load_balancing>nearest_hostname</load_balancing>\n      <prefer_localhost_replica>0</prefer_localhost_replica>\n      <!-- materialize_ttl_recalculate_only>1</materialize_ttl_recalculate_only> 21.10 and above -->\n    </default>\n  </profiles>\n</yandex>"},"etcKeeperOperatorConfdFiles":null,"etcKeeperOperatorConfigdFiles":{"01-keeper-01-default-config.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<clickhouse>\n    <keeper_server>\n        <coordination_settings>\n            <min_session_timeout_ms>10000</min_session_timeout_ms>\n            <operation_timeout_ms>10000</operation_timeout_ms>\n            <raft_logs_level>information</raft_logs_level>\n            <session_timeout_ms>100000</session_timeout_ms>\n        </coordination_settings>\n        <hostname_checks_enabled>true</hostname_checks_enabled>\n        <log_storage_path>/var/lib/clickhouse-keeper/coordination/logs</log_storage_path>\n        <snapshot_storage_path>/var/lib/clickhouse-keeper/coordination/snapshots</snapshot_storage_path>\n        <storage_path>/var/lib/clickhouse-keeper</storage_path>\n        <tcp_port>2181</tcp_port>\n        <enable_reconfiguration>true</enable_reconfiguration>\n    </keeper_server>\n    <listen_host>::</listen_host>\n    <listen_host>0.0.0.0</listen_host>\n    <listen_try>1</listen_try>\n    <logger>\n        <console>1</console>\n        <level>information</level>\n    </logger>\n    <max_connections>4096</max_connections>\n    <openSSL>\n        <server>\n            <cacheSessions>true</cacheSessions>\n            <certificateFile>/etc/clickhouse-keeper/server.crt</certificateFile>\n            <dhParamsFile>/etc/clickhouse-keeper/dhparam.pem</dhParamsFile>\n            <disableProtocols>sslv2,sslv3</disableProtocols>\n            <loadDefaultCAFile>true</loadDefaultCAFile>\n            <preferServerCiphers>true</preferServerCiphers>\n            <privateKeyFile>/etc/clickhouse-keeper/server.key</privateKeyFile>\n            <verificationMode>none</verificationMode>\n        </server>\n    </openSSL>\n</clickhouse>\n","01-keeper-02-readiness.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<clickhouse>\n    <keeper_server>\n        <http_control>\n            <port>9182</port>\n            <readiness>\n                <endpoint>/ready</endpoint>\n            </readiness>\n        </http_control>\n    </keeper_server>\n</clickhouse>"},"etcKeeperOperatorTemplatesdFiles":{"readme":"Templates in this folder are packaged with an operator and available via 'useTemplate'"},"etcKeeperOperatorUsersdFiles":null,"files":{"config.yaml":{"annotation":{"exclude":[],"include":[]},"clickhouse":{"access":{"password":"","port":8123,"rootCA":"","scheme":"auto","secret":{"name":"{{ include \"altinity-clickhouse-operator.fullname\" . }}","namespace":""},"timeouts":{"connect":1,"query":4},"username":""},"configuration":{"file":{"path":{"common":"chi/config.d","host":"chi/conf.d","user":"chi/users.d"}},"network":{"hostRegexpTemplate":"(chi-{chi}-[^.]+\\d+-\\d+|clickhouse\\-{chi})\\.{namespace}\\.svc\\.cluster\\.local$"},"user":{"default":{"networksIP":["::1","127.0.0.1"],"password":"default","profile":"default","quota":"default"}}},"configurationRestartPolicy":{"rules":[{"rules":[{"settings/*":"yes"},{"settings/access_control_path":"no"},{"settings/dictionaries_config":"no"},{"settings/max_server_memory_*":"no"},{"settings/max_*_to_drop":"no"},{"settings/max_concurrent_queries":"no"},{"settings/models_config":"no"},{"settings/user_defined_executable_functions_config":"no"},{"settings/logger/*":"no"},{"settings/macros/*":"no"},{"settings/remote_servers/*":"no"},{"settings/user_directories/*":"no"},{"zookeeper/*":"yes"},{"files/*.xml":"yes"},{"files/config.d/*.xml":"yes"},{"files/config.d/*dict*.xml":"no"},{"profiles/default/background_*_pool_size":"yes"},{"profiles/default/max_*_for_server":"yes"}],"version":"*"},{"rules":[{"settings/logger":"yes"}],"version":"21.*"}]},"metrics":{"timeouts":{"collect":9}}},"keeper":{"configuration":{"file":{"path":{"common":"chk/keeper_config.d","host":"chk/conf.d","user":"chk/users.d"}}}},"label":{"appendScope":"no","exclude":[],"include":[]},"logger":{"alsologtostderr":"false","log_backtrace_at":"","logtostderr":"true","stderrthreshold":"","v":"1","vmodule":""},"pod":{"terminationGracePeriod":30},"reconcile":{"host":{"wait":{"exclude":true,"include":false,"queries":true}},"runtime":{"reconcileCHIsThreadsNumber":10,"reconcileShardsMaxConcurrencyPercent":50,"reconcileShardsThreadsNumber":5},"statefulSet":{"create":{"onFailure":"ignore"},"update":{"onFailure":"abort","pollInterval":5,"timeout":300}}},"statefulSet":{"revisionHistoryLimit":0},"template":{"chi":{"path":"chi/templates.d","policy":"ApplyOnNextReconcile"},"chk":{"path":"chk/templates.d","policy":"ApplyOnNextReconcile"}},"watch":{"namespaces":[]}}},"keeperConfdFiles":null,"keeperConfigdFiles":{"01-keeper-01-default-config.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<clickhouse>\n    <keeper_server>\n        <coordination_settings>\n            <min_session_timeout_ms>10000</min_session_timeout_ms>\n            <operation_timeout_ms>10000</operation_timeout_ms>\n            <raft_logs_level>information</raft_logs_level>\n            <session_timeout_ms>100000</session_timeout_ms>\n        </coordination_settings>\n        <hostname_checks_enabled>true</hostname_checks_enabled>\n        <log_storage_path>/var/lib/clickhouse-keeper/coordination/logs</log_storage_path>\n        <snapshot_storage_path>/var/lib/clickhouse-keeper/coordination/snapshots</snapshot_storage_path>\n        <storage_path>/var/lib/clickhouse-keeper</storage_path>\n        <tcp_port>2181</tcp_port>\n        <enable_reconfiguration>true</enable_reconfiguration>\n    </keeper_server>\n    <listen_host>::</listen_host>\n    <listen_host>0.0.0.0</listen_host>\n    <listen_try>1</listen_try>\n    <logger>\n        <console>1</console>\n        <level>information</level>\n    </logger>\n    <max_connections>4096</max_connections>\n    <openSSL>\n        <server>\n            <cacheSessions>true</cacheSessions>\n            <certificateFile>/etc/clickhouse-keeper/server.crt</certificateFile>\n            <dhParamsFile>/etc/clickhouse-keeper/dhparam.pem</dhParamsFile>\n            <disableProtocols>sslv2,sslv3</disableProtocols>\n            <loadDefaultCAFile>true</loadDefaultCAFile>\n            <preferServerCiphers>true</preferServerCiphers>\n            <privateKeyFile>/etc/clickhouse-keeper/server.key</privateKeyFile>\n            <verificationMode>none</verificationMode>\n        </server>\n    </openSSL>\n</clickhouse>\n","01-keeper-02-readiness.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<clickhouse>\n    <keeper_server>\n        <http_control>\n            <port>9182</port>\n            <readiness>\n                <endpoint>/ready</endpoint>\n            </readiness>\n        </http_control>\n    </keeper_server>\n</clickhouse>"},"keeperTemplatesdFiles":{"readme":"Templates in this folder are packaged with an operator and available via 'useTemplate'"},"keeperUsersdFiles":null,"keeperconfdFiles":null,"keeperconfigdFiles":{"01-keeper-01-default-config.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<clickhouse>\n    <keeper_server>\n        <coordination_settings>\n            <min_session_timeout_ms>10000</min_session_timeout_ms>\n            <operation_timeout_ms>10000</operation_timeout_ms>\n            <raft_logs_level>information</raft_logs_level>\n            <session_timeout_ms>100000</session_timeout_ms>\n        </coordination_settings>\n        <hostname_checks_enabled>true</hostname_checks_enabled>\n        <log_storage_path>/var/lib/clickhouse-keeper/coordination/logs</log_storage_path>\n        <snapshot_storage_path>/var/lib/clickhouse-keeper/coordination/snapshots</snapshot_storage_path>\n        <storage_path>/var/lib/clickhouse-keeper</storage_path>\n        <tcp_port>2181</tcp_port>\n        <enable_reconfiguration>true</enable_reconfiguration>\n    </keeper_server>\n    <listen_host>::</listen_host>\n    <listen_host>0.0.0.0</listen_host>\n    <listen_try>1</listen_try>\n    <logger>\n        <console>1</console>\n        <level>information</level>\n    </logger>\n    <max_connections>4096</max_connections>\n    <openSSL>\n        <server>\n            <cacheSessions>true</cacheSessions>\n            <certificateFile>/etc/clickhouse-keeper/server.crt</certificateFile>\n            <dhParamsFile>/etc/clickhouse-keeper/dhparam.pem</dhParamsFile>\n            <disableProtocols>sslv2,sslv3</disableProtocols>\n            <loadDefaultCAFile>true</loadDefaultCAFile>\n            <preferServerCiphers>true</preferServerCiphers>\n            <privateKeyFile>/etc/clickhouse-keeper/server.key</privateKeyFile>\n            <verificationMode>none</verificationMode>\n        </server>\n    </openSSL>\n</clickhouse>\n","01-keeper-02-readiness.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<clickhouse>\n    <keeper_server>\n        <http_control>\n            <port>9182</port>\n            <readiness>\n                <endpoint>/ready</endpoint>\n            </readiness>\n        </http_control>\n    </keeper_server>\n</clickhouse>"},"keepertemplatesdFiles":{"readme":"Templates in this folder are packaged with an operator and available via 'useTemplate'"},"keeperusersdFiles":null,"templatesdFiles":{"001-templates.json.example":"{\n  \"apiVersion\": \"clickhouse.altinity.com/v1\",\n  \"kind\": \"ClickHouseInstallationTemplate\",\n  \"metadata\": {\n    \"name\": \"01-default-volumeclaimtemplate\"\n  },\n  \"spec\": {\n    \"templates\": {\n      \"volumeClaimTemplates\": [\n        {\n          \"name\": \"chi-default-volume-claim-template\",\n          \"spec\": {\n            \"accessModes\": [\n              \"ReadWriteOnce\"\n            ],\n            \"resources\": {\n              \"requests\": {\n                \"storage\": \"2Gi\"\n              }\n            }\n          }\n        }\n      ],\n      \"podTemplates\": [\n        {\n          \"name\": \"chi-default-oneperhost-pod-template\",\n          \"distribution\": \"OnePerHost\",\n          \"spec\": {\n            \"containers\" : [\n              {\n                \"name\": \"clickhouse\",\n                \"image\": \"clickhouse/clickhouse-server:23.8\",\n                \"ports\": [\n                  {\n                    \"name\": \"http\",\n                    \"containerPort\": 8123\n                  },\n                  {\n                    \"name\": \"client\",\n                    \"containerPort\": 9000\n                  },\n                  {\n                    \"name\": \"interserver\",\n                    \"containerPort\": 9009\n                  }\n                ]\n              }\n            ]\n          }\n        }\n      ]\n    }\n  }\n}\n","default-pod-template.yaml.example":"apiVersion: \"clickhouse.altinity.com/v1\"\nkind: \"ClickHouseInstallationTemplate\"\nmetadata:\n  name: \"default-oneperhost-pod-template\"\nspec:\n  templates:\n    podTemplates:\n      - name: default-oneperhost-pod-template\n        distribution: \"OnePerHost\"\n","default-storage-template.yaml.example":"apiVersion: \"clickhouse.altinity.com/v1\"\nkind: \"ClickHouseInstallationTemplate\"\nmetadata:\n  name: \"default-storage-template-2Gi\"\nspec:\n  templates:\n    volumeClaimTemplates:\n      - name: default-storage-template-2Gi\n        spec:\n          accessModes:\n            - ReadWriteOnce\n          resources:\n            requests:\n              storage: 2Gi\n","readme":"Templates in this folder are packaged with an operator and available via 'useTemplate'"},"usersdFiles":{"01-clickhouse-operator-profile.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<!--\n#\n# Template parameters available:\n#\n-->\n<yandex>\n    <!-- clickhouse-operator user is generated by the operator based on config.yaml in runtime -->\n    <profiles>\n        <clickhouse_operator>\n            <log_queries>0</log_queries>\n            <skip_unavailable_shards>1</skip_unavailable_shards>\n            <http_connection_timeout>10</http_connection_timeout>\n            <max_concurrent_queries_for_all_users>0</max_concurrent_queries_for_all_users>\n            <os_thread_priority>0</os_thread_priority>\n        </clickhouse_operator>\n    </profiles>\n</yandex>\n","02-clickhouse-default-profile.xml":"<!-- IMPORTANT -->\n<!-- This file is auto-generated -->\n<!-- Do not edit this file - all changes would be lost -->\n<!-- Edit appropriate template in the following folder: -->\n<!-- deploy/builder/templates-config -->\n<!-- IMPORTANT -->\n<yandex>\n  <profiles>\n    <default>\n      <os_thread_priority>2</os_thread_priority>\n      <log_queries>1</log_queries>\n      <connect_timeout_with_failover_ms>1000</connect_timeout_with_failover_ms>\n      <distributed_aggregation_memory_efficient>1</distributed_aggregation_memory_efficient>\n      <parallel_view_processing>1</parallel_view_processing>\n      <do_not_merge_across_partitions_select_final>1</do_not_merge_across_partitions_select_final>\n      <load_balancing>nearest_hostname</load_balancing>\n      <prefer_localhost_replica>0</prefer_localhost_replica>\n      <!-- materialize_ttl_recalculate_only>1</materialize_ttl_recalculate_only> 21.10 and above -->\n    </default>\n  </profiles>\n</yandex>"}}` | clickhouse-operator configs |
| dashboards.additionalLabels | object | `{"grafana_dashboard":""}` | labels to add to a secret with dashboards |
| dashboards.annotations | object | `{}` | annotations to add to a secret with dashboards |
| dashboards.enabled | bool | `false` | provision grafana dashboards as configMaps (can be synced by grafana dashboards sidecar https://github.com/grafana/helm-charts/blob/grafana-8.3.4/charts/grafana/values.yaml#L778 ) |
| dashboards.grafana_folder | string | `"clickhouse"` |  |
| fullnameOverride | string | `""` | full name of the chart. |
| imagePullSecrets | list | `[]` | image pull secret for private images in clickhouse-operator pod |
| metrics.containerSecurityContext | object | `{}` |  |
| metrics.enabled | bool | `true` |  |
| metrics.env | list | `[]` | additional environment variables for the deployment of metrics-exporter containers |
| metrics.image.pullPolicy | string | `"IfNotPresent"` | image pull policy |
| metrics.image.repository | string | `"altinity/metrics-exporter"` | image repository |
| metrics.image.tag | string | `""` | image tag (chart's appVersion value will be used if not set) |
| metrics.resources | object | `{}` | custom resource configuration |
| nameOverride | string | `""` | override name of the chart |
| nodeSelector | object | `{}` | node for scheduler pod assignment, look `kubectl explain pod.spec.nodeSelector` for details |
| operator.containerSecurityContext | object | `{}` |  |
| operator.env | list | `[]` | additional environment variables for the clickhouse-operator container in deployment |
| operator.image.pullPolicy | string | `"IfNotPresent"` | image pull policy |
| operator.image.repository | string | `"altinity/clickhouse-operator"` | image repository |
| operator.image.tag | string | `""` | image tag (chart's appVersion value will be used if not set) |
| operator.resources | object | `{}` | custom resource configuration, look `kubectl explain pod.spec.containers.resources` for details |
| podAnnotations | object | `{"clickhouse-operator-metrics/port":"9999","clickhouse-operator-metrics/scrape":"true","prometheus.io/port":"8888","prometheus.io/scrape":"true"}` | annotations to add to the clickhouse-operator pod, look `kubectl explain pod.spec.annotations` for details |
| podLabels | object | `{}` | labels to add to the clickhouse-operator pod |
| podSecurityContext | object | `{}` |  |
| rbac.create | bool | `true` | specifies whether cluster roles and cluster role bindings should be created |
| secret.create | bool | `true` | create a secret with operator credentials |
| secret.password | string | `"clickhouse_operator_password"` | operator credentials password |
| secret.username | string | `"clickhouse_operator"` | operator credentials username |
| serviceAccount.annotations | object | `{}` | annotations to add to the service account |
| serviceAccount.create | bool | `true` | specifies whether a service account should be created |
| serviceAccount.name | string | `nil` | the name of the service account to use; if not set and create is true, a name is generated using the fullname template |
| serviceMonitor.additionalLabels | object | `{}` | additional labels for service monitor |
| serviceMonitor.enabled | bool | `false` | ServiceMonitor Custom resource is created for a (prometheus-operator)[https://github.com/prometheus-operator/prometheus-operator] |
| tolerations | list | `[]` | tolerations for scheduler pod assignment, look `kubectl explain pod.spec.tolerations` for details |
| topologySpreadConstraints | list | `[]` |  |
